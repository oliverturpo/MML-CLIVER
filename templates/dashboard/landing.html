{% extends 'base.html' %}

{% block title %}Proyectos ML - Grupo B{% endblock %}

{% block content %}
<!-- Primera Sección: Hero + Stats con Background Slideshow -->
<div class="relative min-h-screen flex flex-col justify-center">
    <!-- Background Image Slider (Train Effect) -->
    <div class="absolute inset-0 overflow-hidden">
        <div id="bg-slider" class="flex w-[400%] h-full transition-transform duration-[2000ms] ease-in-out">
            <!-- Imagen 1: Machine Learning Algorithm -->
            <div class="w-1/4 h-full bg-cover bg-center bg-no-repeat flex-shrink-0"
                 style="background-image: linear-gradient(rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3)), url('https://images.unsplash.com/photo-1555949963-aa79dcee981c?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');">
            </div>

            <!-- Imagen 2: Data Science -->
            <div class="w-1/4 h-full bg-cover bg-center bg-no-repeat flex-shrink-0"
                 style="background-image: linear-gradient(rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3)), url('https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');">
            </div>

            <!-- Imagen 3: Neural Networks -->
            <div class="w-1/4 h-full bg-cover bg-center bg-no-repeat flex-shrink-0"
                 style="background-image: linear-gradient(rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3)), url('https://images.unsplash.com/photo-1518186285589-2f7649de83e0?ixlib=rb-4.0.3&auto=format&fit=crop&w=2074&q=80');">
            </div>

            <!-- Imagen 4: Code & Analytics -->
            <div class="w-1/4 h-full bg-cover bg-center bg-no-repeat flex-shrink-0"
                 style="background-image: linear-gradient(rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3)), url('https://images.unsplash.com/photo-1504868584819-f8e8b4b6d7e3?ixlib=rb-4.0.3&auto=format&fit=crop&w=2076&q=80');">
            </div>
        </div>
    </div>

    <!-- Contenido sobre el fondo -->
    <div class="relative z-10 container mx-auto px-4 py-20">
        <!-- Hero Section -->
        <div class="text-center text-white mb-16 fade-in">
            <div class="mb-8">
                <i class="fas fa-graduation-cap text-7xl opacity-90 drop-shadow-lg"></i>
            </div>
            <h1 class="text-6xl md:text-7xl font-bold mb-6 drop-shadow-lg">
                Proyectos de Machine Learning
            </h1>
            <h2 class="text-2xl md:text-3xl font-light mb-8 opacity-95 drop-shadow-md">
                Aprendizaje Supervisado - Grupo B - Ciclo VII
            </h2>
            <p class="text-xl md:text-2xl mb-10 opacity-90 max-w-5xl mx-auto leading-relaxed drop-shadow-md">
                Explora los proyectos de tus compañeros de clase y descubre diferentes implementaciones de algoritmos de Machine Learning
            </p>
            <div class="flex gap-6 justify-center flex-wrap">
                <a href="{% url 'registro' %}" class="bg-white/20 backdrop-blur-md text-white px-10 py-4 rounded-full font-semibold text-lg transition-all duration-300 hover:bg-white/30 hover:shadow-2xl hover:-translate-y-1 border border-white/30">
                    <i class="fas fa-user-plus mr-3"></i>
                    Registrar mi Perfil
                </a>
                <a href="#proyectos" class="border-2 border-white text-white px-10 py-4 rounded-full font-semibold text-lg transition-all duration-300 hover:bg-white hover:text-purple-600 hover:-translate-y-1 backdrop-blur-md">
                    <i class="fas fa-arrow-down mr-3"></i>
                    Ver Proyectos
                </a>
            </div>
        </div>

        <!-- Stats Section -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
            <div class="bg-white/20 backdrop-blur-md rounded-3xl p-8 text-center fade-in transition-all duration-300 hover:-translate-y-3 hover:bg-white/30 border border-white/30">
                <div class="text-5xl font-bold text-white mb-3 drop-shadow-lg">{{ perfiles|length }}</div>
                <div class="text-white/90 font-medium text-lg">Proyectos Registrados</div>
            </div>
            <div class="bg-white/20 backdrop-blur-md rounded-3xl p-8 text-center fade-in transition-all duration-300 hover:-translate-y-3 hover:bg-white/30 border border-white/30">
                <div class="text-5xl font-bold text-white mb-3 drop-shadow-lg">6</div>
                <div class="text-white/90 font-medium text-lg">Algoritmos Disponibles</div>
            </div>
            <div class="bg-white/20 backdrop-blur-md rounded-3xl p-8 text-center fade-in transition-all duration-300 hover:-translate-y-3 hover:bg-white/30 border border-white/30">
                <div class="text-5xl font-bold text-white mb-3 drop-shadow-lg">100%</div>
                <div class="text-white/90 font-medium text-lg">Aprendizaje Supervisado</div>
            </div>
        </div>
    </div>
</div>

<!-- Segunda Sección: Galería de Proyectos -->
<div id="proyectos" class="relative overflow-hidden">
    <!-- Fondo con patrones geométricos -->
    <div class="absolute inset-0 bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50"></div>
    <div class="absolute inset-0 opacity-5">
        <div class="absolute top-10 left-10 w-64 h-64 bg-gradient-to-r from-blue-400 to-purple-500 rounded-full blur-3xl"></div>
        <div class="absolute top-1/3 right-10 w-48 h-48 bg-gradient-to-r from-purple-400 to-pink-500 rounded-full blur-3xl"></div>
        <div class="absolute bottom-10 left-1/3 w-56 h-56 bg-gradient-to-r from-indigo-400 to-blue-500 rounded-full blur-3xl"></div>
    </div>

    <div class="relative z-10 container mx-auto px-4 py-24">
        <!-- Header mejorado -->
        <div class="text-center mb-20">
            <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-main rounded-2xl shadow-lg mb-8">
                <i class="fas fa-project-diagram text-3xl text-white"></i>
            </div>
            <h2 class="text-6xl md:text-7xl font-bold mb-8 bg-gradient-to-r from-gray-800 via-blue-800 to-purple-800 bg-clip-text text-transparent">
                Galería de Proyectos
            </h2>
            <p class="text-2xl text-gray-600 max-w-4xl mx-auto leading-relaxed mb-8">
                Cada proyecto representa el trabajo y dedicación de nuestros estudiantes
            </p>
            <div class="w-24 h-1 bg-gradient-main rounded-full mx-auto"></div>
        </div>

        <!-- Sección de Avatares con Tooltips -->
        {% if perfiles %}
        <div class="text-center mb-16">
            <h3 class="text-2xl font-semibold mb-8 text-gray-700">Nuestros Estudiantes</h3>
            <div class="flex flex-wrap justify-center gap-4 max-w-4xl mx-auto">
                {% for perfil in perfiles %}
                <div class="relative group">
                    <!-- Tooltip -->
                    <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3 px-4 py-2 bg-gray-900 text-white text-sm rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 whitespace-nowrap z-20 shadow-lg">
                        <div class="text-center">
                            <div class="font-semibold">{{ perfil.nombre_completo }}</div>
                            {% if perfil.algoritmo_elegido %}
                                <div class="text-xs text-gray-300 mt-1">{{ perfil.get_algoritmo_elegido_display }}</div>
                            {% endif %}
                        </div>
                        <!-- Flecha del tooltip -->
                        <div class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"></div>
                    </div>

                    <!-- Avatar -->
                    {% if perfil.avatar %}
                        <img class="w-16 h-16 rounded-full border-4 border-white shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer object-cover avatar-ring"
                             src="{{ perfil.avatar.url }}"
                             alt="{{ perfil.nombre_completo }}">
                    {% else %}
                        <div class="w-16 h-16 rounded-full border-4 border-white shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer bg-gradient-main flex items-center justify-center text-white font-bold text-xl avatar-ring">
                            {{ perfil.nombre_completo|first|upper }}
                        </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
            {% if perfiles %}
                {% for perfil in perfiles %}
                <div class="group fade-in">
                    <div class="relative bg-white/80 backdrop-blur-sm rounded-3xl overflow-hidden h-full transition-all duration-500 hover:-translate-y-4 hover:rotate-1 shadow-xl hover:shadow-2xl border border-white/20 group-hover:bg-white/90 card-shine">
                    <!-- Decoración superior -->
                    <div class="absolute top-0 left-0 w-full h-2 bg-gradient-main"></div>

                    <!-- Avatar Section -->
                    <div class="relative text-center p-8 bg-gradient-to-br from-blue-50 to-purple-50">
                        <div class="absolute inset-0 bg-gradient-main opacity-10 rounded-t-3xl"></div>
                        {% if perfil.avatar %}
                            <div class="relative">
                                <div class="w-24 h-24 rounded-full bg-gradient-main p-1 mx-auto">
                                    <img src="{{ perfil.avatar.url }}"
                                         alt="{{ perfil.nombre_completo }}"
                                         class="w-full h-full rounded-full object-cover">
                                </div>
                                <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-green-400 rounded-full border-4 border-white flex items-center justify-center">
                                    <i class="fas fa-check text-white text-xs"></i>
                                </div>
                            </div>
                        {% else %}
                            <div class="relative">
                                <div class="w-24 h-24 rounded-full bg-gradient-main inline-flex items-center justify-center shadow-xl text-3xl font-bold text-white mx-auto">
                                    {{ perfil.nombre_completo|first|upper }}
                                </div>
                                <div class="absolute -bottom-2 -right-2 w-8 h-8 bg-green-400 rounded-full border-4 border-white flex items-center justify-center">
                                    <i class="fas fa-check text-white text-xs"></i>
                                </div>
                            </div>
                        {% endif %}
                    </div>

                    <div class="p-8">
                        <!-- Student Name -->
                        <div class="text-center mb-6">
                            <h5 class="font-bold text-xl mb-2 text-gray-800">
                                {{ perfil.nombre_completo }}
                            </h5>
                            <p class="text-gray-500 text-sm bg-gray-100 px-3 py-1 rounded-full inline-block">{{ perfil.carrera }}</p>
                        </div>

                        <!-- Algorithm Badge -->
                        <div class="mb-6">
                            {% if perfil.algoritmo_elegido %}
                                <div class="relative w-full bg-gradient-main text-white p-4 rounded-2xl text-center font-medium shadow-lg overflow-hidden">
                                    <div class="absolute inset-0 bg-white opacity-10"></div>
                                    <div class="relative z-10">
                                        <i class="fas fa-robot mr-2 text-lg"></i>
                                        {{ perfil.get_algoritmo_elegido_display }}
                                    </div>
                                    <div class="absolute top-0 right-0 w-16 h-16 bg-white opacity-10 rounded-full -mr-8 -mt-8"></div>
                                </div>
                            {% else %}
                                <div class="w-full bg-gradient-to-r from-gray-400 to-gray-500 text-white p-4 rounded-2xl text-center font-medium shadow-lg">
                                    <i class="fas fa-hourglass-half mr-2"></i>
                                    Algoritmo no seleccionado
                                </div>
                            {% endif %}
                        </div>

                        <!-- Dataset Info -->
                        {% if perfil.dataset_nombre %}
                        <div class="mb-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border-l-4 border-blue-400">
                            <div class="flex items-center">
                                <i class="fas fa-database text-blue-500 mr-3 text-lg"></i>
                                <div>
                                    <p class="text-sm font-medium text-gray-700">Dataset</p>
                                    <p class="text-blue-700 font-semibold">{{ perfil.dataset_nombre }}</p>
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        <!-- Metrics -->
                        {% if perfil.metricas %}
                        <div class="mb-6">
                            <div class="flex items-center mb-4">
                                <i class="fas fa-chart-line text-green-500 mr-3 text-lg"></i>
                                <h6 class="font-semibold text-gray-700">Métricas de Rendimiento</h6>
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                {% for metrica, valor in perfil.metricas.items %}
                                    <div class="bg-gradient-to-br from-green-50 to-emerald-50 p-3 rounded-xl text-center border border-green-100">
                                        <div class="text-xs font-bold text-green-600 uppercase tracking-wide">{{ metrica }}</div>
                                        <div class="text-lg font-bold text-green-800">{{ valor|floatformat:3 }}</div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        {% endif %}

                        <!-- Registration Date -->
                        <div class="mb-6 flex items-center justify-center text-sm text-gray-500 bg-gray-50 py-2 px-4 rounded-full">
                            <i class="far fa-calendar mr-2"></i>
                            Registrado: {{ perfil.fecha_registro|date:"d/m/Y" }}
                        </div>

                        <!-- View Project Button -->
                        <a href="{% url 'login_pin' perfil.id %}" class="group/btn relative w-full bg-gradient-main text-white py-4 px-6 rounded-2xl font-semibold text-center block transition-all duration-300 hover:shadow-2xl hover:-translate-y-1 overflow-hidden">
                            <div class="absolute inset-0 bg-white opacity-0 group-hover/btn:opacity-20 transition-opacity duration-300"></div>
                            <div class="relative z-10 flex items-center justify-center">
                                <i class="fas fa-lock mr-3 transition-transform group-hover/btn:scale-110"></i>
                                Ver Proyecto
                                <i class="fas fa-arrow-right ml-3 transition-transform group-hover/btn:translate-x-1"></i>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
                <!-- Empty State Mejorado -->
                <div class="col-span-full">
                    <div class="relative bg-white/90 backdrop-blur-sm text-center py-20 fade-in rounded-3xl shadow-2xl border border-white/20 overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-br from-blue-50 to-purple-50 opacity-50"></div>
                        <div class="relative z-10">
                            <div class="inline-flex items-center justify-center w-32 h-32 bg-gradient-main rounded-full mb-8 shadow-xl">
                                <i class="fas fa-rocket text-5xl text-white"></i>
                            </div>
                            <h4 class="text-4xl font-bold mb-6 bg-gradient-to-r from-gray-800 to-blue-800 bg-clip-text text-transparent">¡Sé el Primero!</h4>
                            <p class="text-gray-600 mb-10 text-xl max-w-2xl mx-auto leading-relaxed">
                                Inaugura nuestra galería registrando tu proyecto de Machine Learning y forma parte de la historia
                            </p>
                            <a href="{% url 'registro' %}" class="inline-flex items-center bg-gradient-main text-white px-12 py-5 rounded-2xl font-bold text-lg transition-all duration-300 hover:shadow-2xl hover:-translate-y-2 hover:scale-105">
                                <i class="fas fa-user-plus mr-3 text-xl"></i>
                                Registrarme Ahora
                                <i class="fas fa-arrow-right ml-3 transition-transform hover:translate-x-1"></i>
                            </a>
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>

        <!-- Call to Action Final -->
        <div class="relative mt-24 p-16 text-center fade-in rounded-3xl overflow-hidden">
            <!-- Fondo con gradiente y efectos -->
            <div class="absolute inset-0 bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600"></div>
            <div class="absolute inset-0 bg-black opacity-10"></div>
            <div class="absolute top-0 left-0 w-full h-full">
                <div class="absolute top-10 left-10 w-32 h-32 bg-white opacity-10 rounded-full blur-xl"></div>
                <div class="absolute bottom-10 right-10 w-40 h-40 bg-white opacity-10 rounded-full blur-xl"></div>
                <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-white opacity-5 rounded-full blur-2xl"></div>
            </div>

            <div class="relative z-10">
                <div class="inline-flex items-center justify-center w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl mb-8">
                    <i class="fas fa-graduation-cap text-3xl text-white"></i>
                </div>
                <h3 class="text-5xl font-bold mb-8 text-white leading-tight">
                    ¿Listo para <span class="bg-white/20 px-4 py-2 rounded-2xl">Brillar</span>?
                </h3>
                <p class="text-2xl text-white/90 mb-12 max-w-4xl mx-auto leading-relaxed">
                    Únete a la élite de estudiantes y comparte tu experiencia con Machine Learning
                </p>
                <div class="flex gap-8 justify-center flex-wrap">
                    <a href="{% url 'registro' %}" class="group inline-flex items-center bg-white text-purple-600 px-12 py-5 rounded-2xl font-bold text-lg transition-all duration-300 hover:shadow-2xl hover:-translate-y-2 hover:scale-105">
                        <i class="fas fa-rocket mr-3 text-xl group-hover:animate-bounce"></i>
                        Comenzar Ahora
                        <i class="fas fa-arrow-right ml-3 transition-transform group-hover:translate-x-2"></i>
                    </a>
                    <a href="#" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="inline-flex items-center border-2 border-white text-white px-12 py-5 rounded-2xl font-bold text-lg transition-all duration-300 hover:bg-white hover:text-purple-600 hover:-translate-y-2">
                        <i class="fas fa-arrow-up mr-3"></i>
                        Volver al Inicio
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    /* Tooltip Animations */
    .tooltip-enter {
        animation: tooltipEnter 0.3s ease-out;
    }

    @keyframes tooltipEnter {
        from {
            opacity: 0;
            transform: translateX(-50%) translateY(10px) scale(0.8);
        }
        to {
            opacity: 1;
            transform: translateX(-50%) translateY(0) scale(1);
        }
    }

    /* Avatar Ring Animation */
    .avatar-ring {
        position: relative;
    }

    .avatar-ring::before {
        content: '';
        position: absolute;
        inset: -4px;
        border-radius: 50%;
        background: linear-gradient(135deg, #667eea, #764ba2, #667eea);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    .avatar-ring:hover::before {
        opacity: 1;
        animation: rotate 2s linear infinite;
    }

    @keyframes rotate {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    /* Card Shine Effect */
    .card-shine {
        position: relative;
        overflow: hidden;
    }

    .card-shine::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        transition: left 0.5s ease;
    }

    .card-shine:hover::before {
        left: 100%;
    }

    /* Floating Animation */
    .float {
        animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-10px); }
    }

    /* Gradient Border Animation */
    .gradient-border {
        position: relative;
        background: linear-gradient(135deg, #667eea, #764ba2);
        border-radius: 1rem;
        padding: 2px;
    }

    .gradient-border::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        background: linear-gradient(135deg, #667eea, #764ba2, #667eea, #764ba2);
        mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask-composite: xor;
        animation: gradientRotate 3s linear infinite;
    }

    @keyframes gradientRotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* Pulse Effect */
    .pulse-custom {
        animation: pulseCustom 2s infinite;
    }

    @keyframes pulseCustom {
        0%, 100% {
            transform: scale(1);
            opacity: 1;
        }
        50% {
            transform: scale(1.05);
            opacity: 0.8;
        }
    }

    /* Glass Morphism Enhanced */
    .glass-enhanced {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    /* Text Glow Effect */
    .text-glow {
        text-shadow: 0 0 10px rgba(102, 126, 234, 0.5),
                     0 0 20px rgba(102, 126, 234, 0.3),
                     0 0 30px rgba(102, 126, 234, 0.2);
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Background Image Slider (Train Effect)
    const slider = document.getElementById('bg-slider');
    const totalSlides = 4;
    let currentSlide = 0;

    function slideToNext() {
        if (!slider) return;

        // Mover al siguiente slide
        currentSlide = (currentSlide + 1) % totalSlides;

        // Calcular el desplazamiento (cada slide es 25% del ancho total)
        const translateX = -(currentSlide * 25);

        // Obtener parallax actual si existe
        const scrolled = window.pageYOffset;
        const parallaxY = scrolled * 0.3;

        // Aplicar ambas transformaciones
        slider.style.transform = `translateX(${translateX}%) translateY(${parallaxY}px)`;
    }

    // Inicializar slider
    if (slider) {
        // Cambiar imagen cada 4 segundos con efecto de deslizamiento
        setInterval(slideToNext, 4000);

        // Precargar todas las imágenes para transiciones suaves
        const imageUrls = [
            '/static/img/imagen1.jpg',
            '/static/img/imagen2.jpg',
            '/static/img/imagen3.jpg',
            '/static/img/imagen4.jpg'
        ];

        imageUrls.forEach(url => {
            const img = new Image();
            img.src = url;
        });
    }

    // Smooth scroll para enlaces ancla
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Intersection Observer para animaciones
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.animationDelay = Math.random() * 0.3 + 's';
                entry.target.classList.add('fade-in');
            }
        });
    }, observerOptions);

    // Observar elementos con animación
    document.querySelectorAll('.fade-in').forEach(el => {
        observer.observe(el);
    });

    // Parallax effect para la primera sección
    window.addEventListener('scroll', () => {
        const scrolled = window.pageYOffset;
        const parallax = document.querySelector('#bg-slider');
        if (parallax) {
            const speed = scrolled * 0.3;
            const translateX = -(currentSlide * 25);
            parallax.style.transform = `translateX(${translateX}%) translateY(${speed}px)`;
        }
    });
});
</script>
{% endblock %}